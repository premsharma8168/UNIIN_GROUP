function _array_like_to_array(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _array_with_holes(arr){if(Array.isArray(arr))return arr}function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}function _assert_this_initialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _class_call_check(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _construct(Parent,args,Class){if(_is_native_reflect_construct()){_construct=Reflect.construct}else{_construct=function construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_set_prototype_of(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _create_class(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _define_property(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _get_prototype_of(o){_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _get_prototype_of(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_set_prototype_of(subClass,superClass)}function _is_native_function(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _iterable_to_array(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _iterable_to_array_limit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_define_property(target,key,source[key])})}return target}function _possible_constructor_return(self,call){if(call&&(_type_of(call)==="object"||typeof call==="function")){return call}return _assert_this_initialized(self)}function _set_prototype_of(o,p){_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){o.__proto__=p;return o};return _set_prototype_of(o,p)}function _sliced_to_array(arr,i){return _array_with_holes(arr)||_iterable_to_array_limit(arr,i)||_unsupported_iterable_to_array(arr,i)||_non_iterable_rest()}function _to_consumable_array(arr){return _array_without_holes(arr)||_iterable_to_array(arr)||_unsupported_iterable_to_array(arr)||_non_iterable_spread()}function _type_of(obj){"@swc/helpers - typeof";return obj&&typeof Symbol!=="undefined"&&obj.constructor===Symbol?"symbol":typeof obj}function _unsupported_iterable_to_array(o,minLen){if(!o)return;if(typeof o==="string")return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}function _wrap_native_super(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrap_native_super=function wrapNativeSuper(Class){if(Class===null||!_is_native_function(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_get_prototype_of(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _set_prototype_of(Wrapper,Class)};return _wrap_native_super(Class)}function _is_native_reflect_construct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _create_super(Derived){var hasNativeReflectConstruct=_is_native_reflect_construct();return function _createSuperInternal(){var Super=_get_prototype_of(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possible_constructor_return(this,result)}};(function(){var suffix=Math.random().toString(32).slice(2);function chatbotkitWidgetInit(){var style=document.createElement("style");style.appendChild(document.createTextNode("\n        .chatbotkit-mobile-body-open-".concat(suffix," {\n          position: fixed;\n          width: 100%;\n          height: 100%;\n          overflow: auto;\n        }\n\n        .chatbotkit-mobile-body-open-").concat(suffix," chatbotkit-widget {\n          height: -webkit-fill-available;\n        }\n      ")));document.body.appendChild(style)}if(document.readyState!=="loading"){chatbotkitWidgetInit()}else{document.addEventListener("DOMContentLoaded",function(){chatbotkitWidgetInit()})}var isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1;var ChatBotKitWidget=function(HTMLElement1){"use strict";_inherits(ChatBotKitWidget,HTMLElement1);var _super=_create_super(ChatBotKitWidget);function ChatBotKitWidget(){_class_call_check(this,ChatBotKitWidget);var _this;_this=_super.call(this);_this.onMessage=_this.onMessage.bind(_assert_this_initialized(_this));_this.onMatchMedia=_this.onMatchMedia.bind(_assert_this_initialized(_this));_this.mediaMatch=window.matchMedia("screen and (max-width:640px)");var style=document.createElement("style");style.appendChild(document.createTextNode("\n          :host {\n            display: block;\n\n            contain: paint;\n          }\n\n          .wrapper {\n            display: flex;\n\n            width: 100%;\n            height: 100%;\n          }\n\n          .frame {\n            max-width: 100vw;\n            max-height: 100vh;\n            ".concat(isMobile?"max-height: -webkit-fill-available;":"",'\n\n            border: 0px;\n            margin: 0px;\n            padding: 0px;\n\n            transform: translate3d(0,0,0);\n\n            background: transparent;\n\n            color-scheme: normal;\n\n            /*\n            outline: 2px solid red;\n            background: yellow;\n            */\n          }\n\n          @media only screen and (max-width:640px) {\n            .frame[data-open="true"] {\n              width: 100vw ! important;\n              height: 100vh ! important;\n              ').concat(isMobile?"height: -webkit-fill-available ! important;":"","\n            }\n          }\n        ")));var frame=document.createElement("iframe");{frame.setAttribute("class","frame");frame.setAttribute("allow","clipboard-write")}var wrapper=document.createElement("div");{wrapper.setAttribute("class","wrapper");wrapper.appendChild(frame)}var shadow=_this.attachShadow({mode:"open"});{shadow.appendChild(style);shadow.appendChild(wrapper)}_this.frame=frame;return _this}_create_class(ChatBotKitWidget,[{key:"open",get:function get(){return this.getAttribute("open")==="true"},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("open",{true:true,false:false}[value.toString()||"false"]||"false")}},{key:"session",get:function get(){return this.getAttribute("session")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("session",value)}},{key:"widget",get:function get(){return this.getAttribute("widget")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("widget",value)}},{key:"layout",get:function get(){return this.getAttribute("layout")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("layout",value)}},{key:"barIcon",get:function get(){return this.getAttribute("barIcon")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("barIcon",value)}},{key:"barTitle",get:function get(){return this.getAttribute("barTitle")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("barTitle",value)}},{key:"botIcon",get:function get(){return this.getAttribute("botIcon")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("botIcon",value)}},{key:"userIcon",get:function get(){return this.getAttribute("userIcon")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("userIcon",value)}},{key:"buttonIcon",get:function get(){return this.getAttribute("buttonIcon")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("buttonIcon",value)}},{key:"placeholder",get:function get(){return this.getAttribute("placeholder")},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("placeholder",value)}},{key:"messages",get:function get(){var messages=this.getAttribute("messages");if(messages){return JSON.parse(messages)}else{return null}},set:function set(value){if(value==null){throw new Error("Unexpected value")}if(!Array.isArray(value)){throw new Error("Unexpected value: messages must be an array of objects")}if(value.some(function(message){return message.type!=="user"})){throw new Error("Unexpected value: message type must be 'user'")}this.setAttribute("messages",JSON.stringify(value))}},{key:"meta",get:function get(){var meta=this.getAttribute("meta");if(meta){return JSON.parse(meta)}else{return null}},set:function set(value){if(value==null){throw new Error("Unexpected value")}if(typeof value!=="object"){throw new Error("Unexpected value: meta must be an object")}this.setAttribute("meta",JSON.stringify(value))}},{key:"host",get:function get(){return this.getAttribute("host")||"static.chatbotkit.com"},set:function set(value){if(value==null){throw new Error("Unexpected value")}this.setAttribute("host",value)}},{key:"url",get:function get(){var url=new URL("https://static.chatbotkit.com/integrations/widget/".concat(this.widget,"/frame?cache=true"));if(this.host){url.host=this.host}var query={session:this.session,layout:this.layout,barIcon:this.barIcon,barTitle:this.barTitle,botIcon:this.botIcon,userIcon:this.userIcon,buttonIcon:this.buttonIcon,placeholder:this.placeholder,messages:this.messages?JSON.stringify(this.messages):undefined,meta:this.meta?JSON.stringify(this.meta):undefined};var _iteratorNormalCompletion=true,_didIteratorError=false,_iteratorError=undefined;try{for(var _iterator=Object.entries(query)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step_value=_sliced_to_array(_step.value,2),name=_step_value[0],value=_step_value[1];if(value!=null&&value!==""){url.searchParams.append(name,value)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return url}},{key:"rebuild",value:function rebuild(){if(!this.widget){return}this.frame.src=this.url.toString()}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,_oldValue,newValue){switch(name){case"open":{this.postMessage({type:"media",props:{media:this.mediaMatch.media,matches:this.mediaMatch.matches}});var open=newValue==="true";this.postMessage({type:"setOpen",props:{value:open}});this.frame.dataset.open=open?"true":"false";break}default:{this.rebuild();break}}}},{key:"connectedCallback",value:function connectedCallback(){window.addEventListener("message",this.onMessage);this.mediaMatch.addEventListener("change",this.onMatchMedia);this.rebuild()}},{key:"disconnectedCallback",value:function disconnectedCallback(){window.removeEventListener("message",this.onMessage);this.mediaMatch.removeEventListener("change",this.onMatchMedia)}},{key:"onMessage",value:function onMessage(event){if(event.origin!==this.url.origin){return}switch(event.data.type){case"ready":{this.postMessage({type:"media",props:{media:this.mediaMatch.media,matches:this.mediaMatch.matches}});var open=this.open;this.postMessage({type:"setOpen",props:{value:open}});this.frame.dataset.open=open?"true":"false";break}case"reset":{this.open=event.data.props.open;if(this.mediaMatch.matches&&event.data.props.open){document.body.classList.add("chatbotkit-mobile-body-open-".concat(suffix))}else{document.body.classList.remove("chatbotkit-mobile-body-open-".concat(suffix))}break}case"resize":{this.frame.style.width=event.data.props.width;this.frame.style.height=event.data.props.height;if(event.data.props.height.toString().startsWith("100vh")){this.frame.style.height=event.data.props.height.replace("100vh","-webkit-fill-available")}break}case"onSend":{var sendEvent=new Event("send");sendEvent.data=event.data.props;this.dispatchEvent(sendEvent);break}case"onReceive":{var receiveEvent=new Event("receive");receiveEvent.data=event.data.props;this.dispatchEvent(receiveEvent);break}}}},{key:"onMatchMedia",value:function onMatchMedia(event){this.postMessage({type:"media",props:{media:event.media,matches:event.matches}});if(event.matches&&this.open){document.body.classList.add("chatbotkit-mobile-body-open-".concat(suffix))}else{document.body.classList.remove("chatbotkit-mobile-body-open-".concat(suffix))}}},{key:"postMessage",value:function postMessage(message){var _this_frame_contentWindow;(_this_frame_contentWindow=this.frame.contentWindow)===null||_this_frame_contentWindow===void 0?void 0:_this_frame_contentWindow.postMessage(message,"*")}},{key:"hide",value:function hide(){this.style.visibility="hidden"}},{key:"show",value:function show(){this.style.visibility="visible"}},{key:"restartConversation",value:function restartConversation(){this.postMessage({type:"restartConversation",props:{}})}},{key:"sendMessage",value:function sendMessage(message){this.postMessage({type:"sendMessage",props:{message:message}})}}],[{key:"observedAttributes",get:function get(){return["open","session","widget","layout","barIcon","barTitle","botIcon","userIcon","buttonIcon","placeholder","messages","meta"]}}]);return ChatBotKitWidget}(_wrap_native_super(HTMLElement));window.customElements.define("chatbotkit-widget",ChatBotKitWidget)})();(function(){var script=document.currentScript;if(!script){return}function propertiesToCSS(properties){var sep=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";var parts=[];Object.entries(properties).forEach(function(param){var _param=_sliced_to_array(param,2),propertyName=_param[0],value=_param[1];if(!propertyName.startsWith(":")){parts.push("".concat(propertyName.replace(/([A-Z])/g,function(ch){return"-".concat(ch.toLowerCase())}),": ").concat(value,";"))}});return parts.join(sep)}function has(o,n){return Object.prototype.hasOwnProperty.call(o,n)}function deepExtend(target){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key]}if(!sources.length){return target}var source=sources.shift();if(source===null||typeof source!=="object"){return target}for(var key in source){if(source.hasOwnProperty(key)){if(typeof target[key]==="object"&&typeof source[key]==="object"){deepExtend(target[key],source[key])}else{target[key]=source[key]}}}return deepExtend.apply(void 0,[target].concat(_to_consumable_array(sources)))}function chatbotkitWidgetInit(){var options=deepExtend({params:_object_spread({layout:"popover",possition:"bottom-right"},Object.fromEntries(new URLSearchParams((script===null||script===void 0?void 0:script.src.replace(/^.*?(\?|#|$)/,""))||"")),Object.assign({},(script===null||script===void 0?void 0:script.dataset)||{})),style:{widget:{}}},window.chatbokitWidgetConfiguration);if(!options.params.widget){return}options=deepExtend(options,{style:{widget:_object_spread({},{"bottom-right":{zIndex:2147483647,position:"fixed",bottom:"0",right:"0"},"bottom-left":{zIndex:2147483647,position:"fixed",bottom:"0",left:"0"},"top-right":{zIndex:2147483647,position:"fixed",top:"0",right:"0"},"top-left":{zIndex:2147483647,position:"fixed",top:"0",left:"0"}}[options.params.possition])}});var chatbotkitWidgetId="chatbotkit-widget-".concat(options.params.widget.replace(/\W+/g,"-").replace(/-+/g,"-").toLowerCase().trim()||Math.random().toString(32).slice(2));var chatbotkitWidgetStyle=document.createElement("style");{chatbotkitWidgetStyle.appendChild(document.createTextNode("\n        #".concat(chatbotkitWidgetId," {\n          ").concat(propertiesToCSS(options.style.widget,"\n"),"\n        }\n    ")));document.body.appendChild(chatbotkitWidgetStyle)}var anchor=document.createElement("a");{anchor.setAttribute("href","https://chatbotkit.com");anchor.setAttribute("rel","follow");anchor.setAttribute("title","The fastest way to build advanced AI chatbots");anchor.textContent="ChatBotKit"}var chatbotkitWidget=document.createElement("chatbotkit-widget");{chatbotkitWidget.setAttribute("id",chatbotkitWidgetId);if(has(options.params,"host")){chatbotkitWidget.setAttribute("host",options.params.host)}else{if(/^(https?:)?\/\/.+/i.test(script.src)){chatbotkitWidget.setAttribute("host",new URL(script.src.replace(/^\/\//,"https://")).host)}}if(has(options.params,"open")){chatbotkitWidget.setAttribute("open",options.params.open)}if(has(options.params,"session")){chatbotkitWidget.setAttribute("session",options.params.session)}if(has(options.params,"widget")){chatbotkitWidget.setAttribute("widget",options.params.widget)}if(has(options.params,"layout")){chatbotkitWidget.setAttribute("layout",options.params.layout)}if(has(options.params,"baricon")){chatbotkitWidget.setAttribute("barIcon",options.params.baricon)}if(has(options.params,"bartitle")){chatbotkitWidget.setAttribute("barTitle",options.params.bartitle)}if(has(options.params,"boticon")){chatbotkitWidget.setAttribute("botIcon",options.params.boticon)}if(has(options.params,"usericon")){chatbotkitWidget.setAttribute("userIcon",options.params.usericon)}if(has(options.params,"messages")){chatbotkitWidget.setAttribute("messages",options.params.messages)}if(has(options.params,"meta")){chatbotkitWidget.setAttribute("meta",options.params.meta)}chatbotkitWidget.appendChild(anchor);document.body.appendChild(chatbotkitWidget)}window.chatbotkitWidget=new(function(){"use strict";function _class(){_class_call_check(this,_class)}_create_class(_class,[{key:"instance",get:function get(){return chatbotkitWidget}},{key:"hide",value:function hide(){return chatbotkitWidget.hide()}},{key:"show",value:function show(){return chatbotkitWidget.show()}},{key:"restartConversation",value:function restartConversation(){return chatbotkitWidget.restartConversation()}},{key:"sendMessage",value:function sendMessage(message){return chatbotkitWidget.sendMessage(message)}},{key:"addEventListener",value:function addEventListener(event,handler){return chatbotkitWidget.addEventListener(event,handler)}},{key:"removeEventListener",value:function removeEventListener(event,handler){return chatbotkitWidget.removeEventListener(event,handler)}}]);return _class}())}if(document.readyState!=="loading"){chatbotkitWidgetInit()}else{document.addEventListener("DOMContentLoaded",function(){chatbotkitWidgetInit()})}})();
